Return-Path: <freedreno-bounces@lists.freedesktop.org>
X-Original-To: lists+freedreno@lfdr.de
Delivered-To: lists+freedreno@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id B175CAEEC9
	for <lists+freedreno@lfdr.de>; Tue, 10 Sep 2019 17:45:42 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 5A6476E0BA;
	Tue, 10 Sep 2019 15:45:41 +0000 (UTC)
X-Original-To: freedreno@lists.freedesktop.org
Delivered-To: freedreno@lists.freedesktop.org
Received: from mail-ed1-x544.google.com (mail-ed1-x544.google.com
 [IPv6:2a00:1450:4864:20::544])
 by gabe.freedesktop.org (Postfix) with ESMTPS id D11FE6E0BA
 for <freedreno@lists.freedesktop.org>; Tue, 10 Sep 2019 15:45:39 +0000 (UTC)
Received: by mail-ed1-x544.google.com with SMTP id f2so11216661edw.3
 for <freedreno@lists.freedesktop.org>; Tue, 10 Sep 2019 08:45:39 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:mime-version:references:in-reply-to:from:date
 :message-id:subject:to:cc;
 bh=ab44L4UsH9lWBk/ePs+t6LQUuKmRHFW0SwCWgf68+rc=;
 b=NNunbf/ySioxS306IyPlKSF+w2AhuvS9BB8Bfkp+q3sLu8/lZtzwH7NCD3LzzaRPs7
 un84VpEaCa6Mi6zL7X9Eg2U69vf3f6Eu0WZy212ARNFO8Xq+QQfAcrBzshXOfzMXTE19
 epsVPC1/IiPLbWCZfiZA5b/0e1gU7HaMsZht6+jAoSf4j1ikjJ7wKraI1gayGLGVFrSo
 6VQcQ+Hpv2PzJt//7c4vZnYLHxpXKlhKJY3ZAe2CHadfj/qqHkO5UqL7/b2GbtikmOBK
 7hc33+Uu/HlqJeXMbv5upsfc/aENSh+mPEapIj/7H8iwmjIPy4PNqAgEgcxQJoeODKZT
 9apw==
X-Gm-Message-State: APjAAAUDxM5OplQ6Gnj/+bPMvqwckhS82OyIsDiPYtmXohL65zIzEz7d
 4CPr98srSp2IvdBuUu1R8RE/W0S5JJ8txyP7dE4=
X-Google-Smtp-Source: APXvYqzoKSvtwc7h3YF+c3ClC8RRDwvQEOuO9vmMklmmZ6/J8nMaSUMmvks3o2VNkPh4WYQkviIc241SjZs7jn1Ep9c=
X-Received: by 2002:a17:906:2451:: with SMTP id
 a17mr16927007ejb.164.1568130338310; 
 Tue, 10 Sep 2019 08:45:38 -0700 (PDT)
MIME-Version: 1.0
References: <20190907175013.24246-1-robdclark@gmail.com>
 <418d8426-f299-1269-2b2e-f86677cf22c2@arm.com>
In-Reply-To: <418d8426-f299-1269-2b2e-f86677cf22c2@arm.com>
From: Rob Clark <robdclark@gmail.com>
Date: Tue, 10 Sep 2019 08:45:27 -0700
Message-ID: <CAF6AEGtd7kr2MckVy99ERQs4gmxjY6DteNdTLknBgpAZRpDgrA@mail.gmail.com>
To: Robin Murphy <robin.murphy@arm.com>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=gmail.com; s=20161025;
 h=mime-version:references:in-reply-to:from:date:message-id:subject:to
 :cc;
 bh=ab44L4UsH9lWBk/ePs+t6LQUuKmRHFW0SwCWgf68+rc=;
 b=FUDx1VssMY5+grYTJ9mTO+OtexdcbSTMSsn3//VPNV0zPdSp95pA3zNOdpx4boIzLL
 +8wfwTnUnSWaD0DyKayLxvtLd1DNtf9KpsXdscr1lunnkyj9RgO10ZaIY4qDgscT06xv
 gsu7UNxm0Xryuv9rrw5a4GpIEVPRKWhPVPWKzBpbTQx6lkHw+mIFYb+srXGudTMQJCt5
 gonRN5rE57R/vyk+7sS8MiPSdeYzF3ZPo7wNMrmBj3lVkr6zixiEP6LKYNeZGu9gq5mv
 nhhDZVq5ROoxeNpfmQu0BO+jdHGVOWyuw0NkkZqryUCoeygfaKH+6X5QUf5q5jC92gdh
 i8nw==
Subject: Re: [Freedreno] [PATCH] iommu/arm-smmu: fix "hang" when games exit
X-BeenThere: freedreno@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Freedreno graphics driver community testing & development
 <freedreno.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/freedreno>,
 <mailto:freedreno-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/freedreno>
List-Post: <mailto:freedreno@lists.freedesktop.org>
List-Help: <mailto:freedreno-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/freedreno>,
 <mailto:freedreno-request@lists.freedesktop.org?subject=subscribe>
Cc: Rob Clark <robdclark@chromium.org>, Jordan Crouse <jcrouse@codeaurora.org>,
 Will Deacon <will@kernel.org>, linux-arm-msm <linux-arm-msm@vger.kernel.org>,
 Joerg Roedel <joro@8bytes.org>, open list <linux-kernel@vger.kernel.org>,
 "list@263.net:IOMMU DRIVERS <iommu@lists.linux-foundation.org>,
 Joerg Roedel <joro@8bytes.org>, " <iommu@lists.linux-foundation.org>,
 freedreno <freedreno@lists.freedesktop.org>,
 "moderated list:ARM SMMU DRIVERS" <linux-arm-kernel@lists.infradead.org>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: freedreno-bounces@lists.freedesktop.org
Sender: "Freedreno" <freedreno-bounces@lists.freedesktop.org>

T24gVHVlLCBTZXAgMTAsIDIwMTkgYXQgODowMSBBTSBSb2JpbiBNdXJwaHkgPHJvYmluLm11cnBo
eUBhcm0uY29tPiB3cm90ZToKPgo+IE9uIDA3LzA5LzIwMTkgMTg6NTAsIFJvYiBDbGFyayB3cm90
ZToKPiA+IEZyb206IFJvYiBDbGFyayA8cm9iZGNsYXJrQGNocm9taXVtLm9yZz4KPiA+Cj4gPiBX
aGVuIGdhbWVzLCBicm93c2VyLCBvciBhbnl0aGluZyB1c2luZyBhIGxvdCBvZiBHUFUgYnVmZmVy
cyBleGl0cywgdGhlcmUKPiA+IGNhbiBiZSBtYW55IGh1bmRyZWRzIG9yIHRob3VzYW5kcyBvZiBi
dWZmZXJzIHRvIHVubWFwIGFuZCBmcmVlLiAgSWYgdGhlCj4gPiBHUFUgaXMgb3RoZXJ3aXNlIHN1
c3BlbmRlZCwgdGhpcyBjYW4gY2F1c2UgYXJtLXNtbXUgdG8gcmVzdW1lL3N1c3BlbmQKPiA+IGZv
ciBlYWNoIGJ1ZmZlciwgcmVzdWx0aW5nIDUtMTAgc2Vjb25kcyB3b3J0aCBvZiByZXByb2dyYW1t
aW5nIHRoZQo+ID4gY29udGV4dCBiYW5rIChhcm1fc21tdV93cml0ZV9jb250ZXh0X2JhbmsoKS9h
cm1fc21tdV93cml0ZV9zMmNyKCkvZXRjKS4KPiA+IFRvIHRoZSB1c2VyIGl0IHdvdWxkIGFwcGVh
ciB0aGF0IHRoZSBzeXN0ZW0gaXMgbG9ja2VkIHVwLgo+ID4KPiA+IEEgc2ltcGxlIHNvbHV0aW9u
IGlzIHRvIHVzZSBwbV9ydW50aW1lX3B1dF9hdXRvc3VzcGVuZCgpIGluc3RlYWQsIHNvIHdlCj4g
PiBkb24ndCBpbW1lZGlhdGVseSBzdXNwZW5kIHRoZSBTTU1VIGRldmljZS4KPiA+Cj4gPiBTaWdu
ZWQtb2ZmLWJ5OiBSb2IgQ2xhcmsgPHJvYmRjbGFya0BjaHJvbWl1bS5vcmc+Cj4gPiAtLS0KPiA+
IE5vdGU6IEkndmUgdGllZCB0aGUgYXV0b3N1c3BlbmQgZW5hYmxlL2RlbGF5IHRvIHRoZSBjb25z
dW1lciBkZXZpY2UsCj4gPiBiYXNlZCBvbiB0aGUgcmVhc29uaW5nIHRoYXQgaWYgdGhlIGNvbnN1
bWVyIGRldmljZSBiZW5lZml0cyBmcm9tIHVzaW5nCj4gPiBhbiBhdXRvc3VzcGVuZCBkZWxheSwg
dGhlbiBpdCdzIGNvcnJlc3BvbmRpbmcgU01NVSBwcm9iYWJseSBkb2VzIHRvby4KPiA+IE1heWJl
IHRoYXQgaXMgb3ZlcmtpbGwgYW5kIHdlIHNob3VsZCBqdXN0IHVuY29uZGl0aW9uYWxseSBlbmFi
bGUKPiA+IGF1dG9zdXNwZW5kLgo+Cj4gSSdtIG5vdCBzdXJlIHRoZXJlJ3MgcmVhbGx5IGFueSBy
ZWFzb24gdG8gZXhwZWN0IHRoYXQgYSBzdXBwbGllcidzIHVzYWdlCj4gbW9kZWwgd2hlbiBkb2lu
ZyB0aGluZ3MgZm9yIGl0c2VsZiBiZWFycyBhbnkgcmVsYXRpb24gdG8gdGhhdCBvZiBpdHMKPiBj
b25zdW1lcihzKSwgc28gSSdkIGNlcnRhaW5seSBsZWFuIHRvd2FyZHMgdGhlICJ1bmNvbmRpdGlv
bmFsIiBhcmd1bWVudAo+IG15c2VsZi4KClNvdW5kcyBnb29kLCBJJ2xsIHJlc3BpbiB3LyB1bmNv
bmRpdGlvbmFsIGF1dG9zdXNwZW5kCgo+IE9mIGNvdXJzZSBpZGVhbGx5IHdlJ2Qgc2tpcCByZXN1
bWluZyBhbHRvZ2V0aGVyIGluIHRoZSBtYXAvdW5tYXAgcGF0aHMKPiAoc2luY2UgcmVzdW1lIGlt
cGxpZXMgYSBmdWxsIFRMQiByZXNldCBhbnl3YXkpLCBidXQgSUlSQyB0aGF0IGFwcHJvYWNoCj4g
c3RhcnRlZCB0byBnZXQgbWVzc3kgaW4gdGhlIGNvbnRleHQgb2YgdGhlIGluaXRpYWwgUlBNIHBh
dGNoc2V0LiBJJ20KPiBwbGFubmluZyB0byBmaWRkbGUgYXJvdW5kIGEgYml0IG1vcmUgdG8gY2xl
YW4gdXAgdGhlIGltcGxlbWVudGF0aW9uIG9mCj4gdGhlIG5ldyBpb21tdV9mbHVzaF9vcHMgc3R1
ZmYsIHNvIEkndmUgbWFkZSBhIG5vdGUgdG8gbXlzZWxmIHRvIHJldmlzaXQKPiBSUE0gdG8gc2Vl
IGlmIHRoZXJlJ3MgYSBzdWZmaWNpZW50bHkgY2xlYW4gd2F5IHRvIGRvIGJldHRlci4gSW4gdGhl
Cj4gbWVhbnRpbWUsIHRob3VnaCwgSSBkb24ndCBoYXZlIGFueSByZWFsIG9iamVjdGlvbiB0byB1
c2luZyBzb21lCj4gcmVhc29uYWJsZSBhdXRvc3VzcGVuZCBkZWxheSBvbiB0aGUgcHJpbmNpcGxl
IHRoYXQgaWYgd2UndmUgYmVlbiB3b2tlbgo+IHVwIHRvIG1hcC91bm1hcCBvbmUgcGFnZSwgdGhl
cmUncyBhIGhpZ2ggbGlrZWxpaG9vZCB0aGF0IG1vcmUgd2lsbAo+IGZvbGxvdyBpbiBzaG9ydCBv
cmRlciAoYW5kIGluIHRoZSBjb25maWd1cmF0aW9uIHNsb3ctcGF0aHMgaXQgd29uJ3QgaGF2ZQo+
IG11Y2ggaW1wYWN0IGVpdGhlciB3YXkpLgoKSXQgZG9lcyBzb3J0IG9mIHJlbWluZCBtZSBhYm91
dCBzb21ldGhpbmcgSSB3YXMgY2hhdHRpbmcgd2l0aCBKb3JkYW4KdGhlIG90aGVyIGRheS4uIGFi
b3V0IGhvdyB3ZSBjb3VsZCBwb3NzaWJseSBza2lwIHRoZSBUTEIgaW52IGZvcgp1bm1hcHMgZnJv
bSBub24tY3VycmVudCBwYWdldGFibGVzIG9uY2Ugd2UgaGF2ZSBwZXItY29udGV4dApwYWdldGFi
bGVzLgoKVGhlIGNoYWxsZW5nZSBpcywgc2luY2UgdGhlIEdQVSdzIGNvbW1hbmQgcGFyc2VyIGlz
IHRoZSBvbmUgc3dpdGNoaW5nCnBhZ2V0YWJsZXMsIHdlIGRvbid0IGhhdmUgYW55IHJhY2UtZnJl
ZSB3YXkgdG8ga25vdyB3aGljaCBwYWdldGFibGVzCmFyZSBjdXJyZW50LiAgQnV0IHdlIGRvIGtu
b3cgd2hpY2ggY29udGV4dHMgaGF2ZSB3b3JrIHF1ZXVlZCB1cCBmb3IKdGhlIEdQVSwgc28gd2Ug
Y2FuIGtub3cgZWl0aGVyIHRoYXQgYSBnaXZlbiBjb250ZXh0IGRlZmluaXRlbHkgaXNuJ3QKY3Vy
cmVudCwgb3IgdGhhdCBpdCBtaWdodCBiZSBjdXJyZW50LiAgQW5kIGluIHRoZSAiZGVmaW5pdGVs
eSBub3QKY3VycmVudCIgY2FzZSB3ZSBjb3VsZCBza2lwIFRMQiBpbnYuCgpCUiwKLVIKCj4KPiBS
b2Jpbi4KPgo+ID4gICBkcml2ZXJzL2lvbW11L2FybS1zbW11LmMgfCAxMSArKysrKysrKysrLQo+
ID4gICAxIGZpbGUgY2hhbmdlZCwgMTAgaW5zZXJ0aW9ucygrKSwgMSBkZWxldGlvbigtKQo+ID4K
PiA+IGRpZmYgLS1naXQgYS9kcml2ZXJzL2lvbW11L2FybS1zbW11LmMgYi9kcml2ZXJzL2lvbW11
L2FybS1zbW11LmMKPiA+IGluZGV4IGMyNzMzYjQ0N2Q5Yy4uNzNhMGRkNTNjOGEzIDEwMDY0NAo+
ID4gLS0tIGEvZHJpdmVycy9pb21tdS9hcm0tc21tdS5jCj4gPiArKysgYi9kcml2ZXJzL2lvbW11
L2FybS1zbW11LmMKPiA+IEBAIC0yODksNyArMjg5LDcgQEAgc3RhdGljIGlubGluZSBpbnQgYXJt
X3NtbXVfcnBtX2dldChzdHJ1Y3QgYXJtX3NtbXVfZGV2aWNlICpzbW11KQo+ID4gICBzdGF0aWMg
aW5saW5lIHZvaWQgYXJtX3NtbXVfcnBtX3B1dChzdHJ1Y3QgYXJtX3NtbXVfZGV2aWNlICpzbW11
KQo+ID4gICB7Cj4gPiAgICAgICBpZiAocG1fcnVudGltZV9lbmFibGVkKHNtbXUtPmRldikpCj4g
PiAtICAgICAgICAgICAgIHBtX3J1bnRpbWVfcHV0KHNtbXUtPmRldik7Cj4gPiArICAgICAgICAg
ICAgIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKHNtbXUtPmRldik7Cj4gPiAgIH0KPiA+Cj4g
PiAgIHN0YXRpYyBzdHJ1Y3QgYXJtX3NtbXVfZG9tYWluICp0b19zbW11X2RvbWFpbihzdHJ1Y3Qg
aW9tbXVfZG9tYWluICpkb20pCj4gPiBAQCAtMTQ0NSw2ICsxNDQ1LDE1IEBAIHN0YXRpYyBpbnQg
YXJtX3NtbXVfYXR0YWNoX2RldihzdHJ1Y3QgaW9tbXVfZG9tYWluICpkb21haW4sIHN0cnVjdCBk
ZXZpY2UgKmRldikKPiA+ICAgICAgIC8qIExvb2tzIG9rLCBzbyBhZGQgdGhlIGRldmljZSB0byB0
aGUgZG9tYWluICovCj4gPiAgICAgICByZXQgPSBhcm1fc21tdV9kb21haW5fYWRkX21hc3Rlcihz
bW11X2RvbWFpbiwgZndzcGVjKTsKPiA+Cj4gPiArI2lmZGVmIENPTkZJR19QTQo+ID4gKyAgICAg
LyogVE9ETyBtYXliZSBkZXZpY2VfbGlua19hZGQoKSBzaG91bGQgZG8gdGhpcyBmb3IgdXM/ICov
Cj4gPiArICAgICBpZiAoZGV2LT5wb3dlci51c2VfYXV0b3N1c3BlbmQpIHsKPiA+ICsgICAgICAg
ICAgICAgcG1fcnVudGltZV9zZXRfYXV0b3N1c3BlbmRfZGVsYXkoc21tdS0+ZGV2LAo+ID4gKyAg
ICAgICAgICAgICAgICAgICAgIGRldi0+cG93ZXIuYXV0b3N1c3BlbmRfZGVsYXkpOwo+ID4gKyAg
ICAgICAgICAgICBwbV9ydW50aW1lX3VzZV9hdXRvc3VzcGVuZChzbW11LT5kZXYpOwo+ID4gKyAg
ICAgfQo+ID4gKyNlbmRpZgo+ID4gKwo+ID4gICBycG1fcHV0Ogo+ID4gICAgICAgYXJtX3NtbXVf
cnBtX3B1dChzbW11KTsKPiA+ICAgICAgIHJldHVybiByZXQ7Cj4gPgpfX19fX19fX19fX19fX19f
X19fX19fX19fX19fX19fX19fX19fX19fX19fX19fXwpGcmVlZHJlbm8gbWFpbGluZyBsaXN0CkZy
ZWVkcmVub0BsaXN0cy5mcmVlZGVza3RvcC5vcmcKaHR0cHM6Ly9saXN0cy5mcmVlZGVza3RvcC5v
cmcvbWFpbG1hbi9saXN0aW5mby9mcmVlZHJlbm8=
