Return-Path: <freedreno-bounces@lists.freedesktop.org>
X-Original-To: lists+freedreno@lfdr.de
Delivered-To: lists+freedreno@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [131.252.210.177])
	by mail.lfdr.de (Postfix) with ESMTPS id 3502E855A4
	for <lists+freedreno@lfdr.de>; Thu,  8 Aug 2019 00:19:59 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id ECA766E773;
	Wed,  7 Aug 2019 22:19:57 +0000 (UTC)
X-Original-To: freedreno@lists.freedesktop.org
Delivered-To: freedreno@lists.freedesktop.org
Received: from smtp.codeaurora.org (smtp.codeaurora.org [198.145.29.96])
 by gabe.freedesktop.org (Postfix) with ESMTPS id 907016E773
 for <freedreno@lists.freedesktop.org>; Wed,  7 Aug 2019 22:19:56 +0000 (UTC)
Received: by smtp.codeaurora.org (Postfix, from userid 1000)
 id 756A160A50; Wed,  7 Aug 2019 22:19:56 +0000 (UTC)
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on
 pdx-caf-mail.web.codeaurora.org
X-Spam-Level: 
X-Spam-Status: No, score=-2.7 required=2.0 tests=ALL_TRUSTED,BAYES_00,
 DKIM_INVALID,DKIM_SIGNED,SPF_NONE autolearn=no autolearn_force=no
 version=3.4.0
Received: from jcrouse1-lnx.qualcomm.com (i-global254.qualcomm.com
 [199.106.103.254])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-SHA256 (128/128 bits))
 (No client certificate requested)
 (Authenticated sender: jcrouse@smtp.codeaurora.org)
 by smtp.codeaurora.org (Postfix) with ESMTPSA id 9C2BD608CE;
 Wed,  7 Aug 2019 22:19:52 +0000 (UTC)
DMARC-Filter: OpenDMARC Filter v1.3.2 smtp.codeaurora.org 9C2BD608CE
From: Jordan Crouse <jcrouse@codeaurora.org>
To: freedreno@lists.freedesktop.org
Date: Wed,  7 Aug 2019 16:19:45 -0600
Message-Id: <1565216386-28309-2-git-send-email-jcrouse@codeaurora.org>
X-Mailer: git-send-email 2.7.4
In-Reply-To: <1565216386-28309-1-git-send-email-jcrouse@codeaurora.org>
References: <1565216386-28309-1-git-send-email-jcrouse@codeaurora.org>
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=codeaurora.org; s=default; t=1565216396;
 bh=kHP/hcA9cXNEJx5zzjXeEo+3ANFzauFLULTr9USX/vI=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=h77DjSuPESyYJzzv7bFVlUoWoiCfqnZmsA3q4p7Krgns7NCwZsfHNVuHIH7/CS6Ez
 uFRzlJOX+MDvCCfOtfvKy0idqwKkG619LcUWPRJ+b6UoNteR181qSGplC5YWwaMUAR
 WsQj6B3OaOyTY2eV+3WnEP0ep8gYDkOnReGFXNHs=
X-Mailman-Original-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple;
 d=codeaurora.org; s=default; t=1565216393;
 bh=kHP/hcA9cXNEJx5zzjXeEo+3ANFzauFLULTr9USX/vI=;
 h=From:To:Cc:Subject:Date:In-Reply-To:References:From;
 b=cPC7+d21TKYASjrDBUqsi6kKa0kM4UyW7MUhj+Qts8ON6L5iRcuPUegkfIxahzfuT
 spgFvF3VZqoRukTDesTfUrJ4NZRHo9+jqt9fPCvnG4cppXv/enDcYejv2WrSD9qX6F
 KxkESzHoaHwMASWn223Z5LaNJHKJpLLTM7K3Z7sE=
X-Mailman-Original-Authentication-Results: pdx-caf-mail.web.codeaurora.org;
 dmarc=none (p=none dis=none)
 header.from=codeaurora.org
X-Mailman-Original-Authentication-Results: pdx-caf-mail.web.codeaurora.org;
 spf=none
 smtp.mailfrom=jcrouse@codeaurora.org
Subject: [Freedreno] [PATCH v3 1/2] iommu/io-pgtable-arm: Add support for
 ARM_ADRENO_GPU_LPAE io-pgtable format
X-BeenThere: freedreno@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Freedreno graphics driver community testing & development
 <freedreno.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/freedreno>,
 <mailto:freedreno-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/freedreno>
List-Post: <mailto:freedreno@lists.freedesktop.org>
List-Help: <mailto:freedreno-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/freedreno>,
 <mailto:freedreno-request@lists.freedesktop.org?subject=subscribe>
Cc: Rob Herring <robh@kernel.org>, Will Deacon <will@kernel.org>,
 jean-philippe.brucker@arm.com, linux-arm-msm@vger.kernel.org,
 Joerg Roedel <joro@8bytes.org>, linux-kernel@vger.kernel.org,
 iommu@lists.linux-foundation.org, Zhen Lei <thunder.leizhen@huawei.com>,
 robin.murphy@arm.com, linux-arm-kernel@lists.infradead.org
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: freedreno-bounces@lists.freedesktop.org
Sender: "Freedreno" <freedreno-bounces@lists.freedesktop.org>

QWRkIGEgbmV3IHN1Yi1mb3JtYXQgQVJNX0FEUkVOT19HUFVfTFBBRSB0byBzZXQgdXAgVFRCUjAg
YW5kIFRUQlIxIGZvcgp1c2UgYnkgdGhlIEFkcmVubyBHUFUuIFRoaXMgd2lsbCBhbGxvdyBUaGUg
R1BVIGRyaXZlciB0byBtYXAgZ2xvYmFsCmJ1ZmZlcnMgaW4gdGhlIFRUQlIxIGFuZCBsZWF2ZSB0
aGUgVFRCUjAgY29uZmlndXJlZCBidXQgdW5zZXQgYW5kCmZyZWUgdG8gYmUgY2hhbmdlZCBkeW5h
bWljYWxseSBieSB0aGUgR1BVLgoKU2lnbmVkLW9mZi1ieTogSm9yZGFuIENyb3VzZSA8amNyb3Vz
ZUBjb2RlYXVyb3JhLm9yZz4KLS0tCgogZHJpdmVycy9pb21tdS9pby1wZ3RhYmxlLWFybS5jIHwg
MjE0ICsrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrKysrLS0tCiBkcml2ZXJzL2lv
bW11L2lvLXBndGFibGUuYyAgICAgfCAgIDEgKwogaW5jbHVkZS9saW51eC9pby1wZ3RhYmxlLmgg
ICAgIHwgICAyICsKIDMgZmlsZXMgY2hhbmdlZCwgMjAyIGluc2VydGlvbnMoKyksIDE1IGRlbGV0
aW9ucygtKQoKZGlmZiAtLWdpdCBhL2RyaXZlcnMvaW9tbXUvaW8tcGd0YWJsZS1hcm0uYyBiL2Ry
aXZlcnMvaW9tbXUvaW8tcGd0YWJsZS1hcm0uYwppbmRleCAxNjFhN2Q1Li44ZWIwZGJiIDEwMDY0
NAotLS0gYS9kcml2ZXJzL2lvbW11L2lvLXBndGFibGUtYXJtLmMKKysrIGIvZHJpdmVycy9pb21t
dS9pby1wZ3RhYmxlLWFybS5jCkBAIC0xMTIsMTMgKzExMiwxOSBAQAogI2RlZmluZSBBUk1fMzJf
TFBBRV9UQ1JfRUFFCQkoMSA8PCAzMSkKICNkZWZpbmUgQVJNXzY0X0xQQUVfUzJfVENSX1JFUzEJ
CSgxIDw8IDMxKQogCisjZGVmaW5lIEFSTV9MUEFFX1RDUl9FUEQwCQkoMSA8PCA3KQogI2RlZmlu
ZSBBUk1fTFBBRV9UQ1JfRVBEMQkJKDEgPDwgMjMpCiAKICNkZWZpbmUgQVJNX0xQQUVfVENSX1RH
MF80SwkJKDAgPDwgMTQpCiAjZGVmaW5lIEFSTV9MUEFFX1RDUl9URzBfNjRLCQkoMSA8PCAxNCkK
ICNkZWZpbmUgQVJNX0xQQUVfVENSX1RHMF8xNksJCSgyIDw8IDE0KQogCisjZGVmaW5lIEFSTV9M
UEFFX1RDUl9URzFfNEsJCSgwIDw8IDMwKQorI2RlZmluZSBBUk1fTFBBRV9UQ1JfVEcxXzY0SwkJ
KDEgPDwgMzApCisjZGVmaW5lIEFSTV9MUEFFX1RDUl9URzFfMTZLCQkoMiA8PCAzMCkKKwogI2Rl
ZmluZSBBUk1fTFBBRV9UQ1JfU0gwX1NISUZUCQkxMgorI2RlZmluZSBBUk1fTFBBRV9UQ1JfU0gx
X1NISUZUCQkyOAogI2RlZmluZSBBUk1fTFBBRV9UQ1JfU0gwX01BU0sJCTB4MwogI2RlZmluZSBB
Uk1fTFBBRV9UQ1JfU0hfTlMJCTAKICNkZWZpbmUgQVJNX0xQQUVfVENSX1NIX09TCQkyCkBAIC0x
MjYsNiArMTMyLDggQEAKIAogI2RlZmluZSBBUk1fTFBBRV9UQ1JfT1JHTjBfU0hJRlQJMTAKICNk
ZWZpbmUgQVJNX0xQQUVfVENSX0lSR04wX1NISUZUCTgKKyNkZWZpbmUgQVJNX0xQQUVfVENSX09S
R04xX1NISUZUCTI2CisjZGVmaW5lIEFSTV9MUEFFX1RDUl9JUkdOMV9TSElGVAkyNAogI2RlZmlu
ZSBBUk1fTFBBRV9UQ1JfUkdOX01BU0sJCTB4MwogI2RlZmluZSBBUk1fTFBBRV9UQ1JfUkdOX05D
CQkwCiAjZGVmaW5lIEFSTV9MUEFFX1RDUl9SR05fV0JXQQkJMQpAQCAtMTM2LDYgKzE0NCw3IEBA
CiAjZGVmaW5lIEFSTV9MUEFFX1RDUl9TTDBfTUFTSwkJMHgzCiAKICNkZWZpbmUgQVJNX0xQQUVf
VENSX1QwU1pfU0hJRlQJCTAKKyNkZWZpbmUgQVJNX0xQQUVfVENSX1QxU1pfU0hJRlQJCTE2CiAj
ZGVmaW5lIEFSTV9MUEFFX1RDUl9TWl9NQVNLCQkweGYKIAogI2RlZmluZSBBUk1fTFBBRV9UQ1Jf
UFNfU0hJRlQJCTE2CkBAIC0xNTIsNiArMTYxLDE0IEBACiAjZGVmaW5lIEFSTV9MUEFFX1RDUl9Q
U180OF9CSVQJCTB4NVVMTAogI2RlZmluZSBBUk1fTFBBRV9UQ1JfUFNfNTJfQklUCQkweDZVTEwK
IAorI2RlZmluZSBBUk1fTFBBRV9UQ1JfU0VQX1NISUZUCQk0NworI2RlZmluZSBBUk1fTFBBRV9U
Q1JfU0VQXzMxCQkoMHgwVUxMIDw8IEFSTV9MUEFFX1RDUl9TRVBfU0hJRlQpCisjZGVmaW5lIEFS
TV9MUEFFX1RDUl9TRVBfMzUJCSgweDFVTEwgPDwgQVJNX0xQQUVfVENSX1NFUF9TSElGVCkKKyNk
ZWZpbmUgQVJNX0xQQUVfVENSX1NFUF8zOQkJKDB4MlVMTCA8PCBBUk1fTFBBRV9UQ1JfU0VQX1NI
SUZUKQorI2RlZmluZSBBUk1fTFBBRV9UQ1JfU0VQXzQxCQkoMHgzVUxMIDw8IEFSTV9MUEFFX1RD
Ul9TRVBfU0hJRlQpCisjZGVmaW5lIEFSTV9MUEFFX1RDUl9TRVBfNDMJCSgweDRVTEwgPDwgQVJN
X0xQQUVfVENSX1NFUF9TSElGVCkKKyNkZWZpbmUgQVJNX0xQQUVfVENSX1NFUF9VUFNUUkVBTQko
MHg3VUxMIDw8IEFSTV9MUEFFX1RDUl9TRVBfU0hJRlQpCisKICNkZWZpbmUgQVJNX0xQQUVfTUFJ
Ul9BVFRSX1NISUZUKG4pCSgobikgPDwgMykKICNkZWZpbmUgQVJNX0xQQUVfTUFJUl9BVFRSX01B
U0sJCTB4ZmYKICNkZWZpbmUgQVJNX0xQQUVfTUFJUl9BVFRSX0RFVklDRQkweDA0CkBAIC00MjYs
NyArNDQzLDggQEAgc3RhdGljIGFybV9scGFlX2lvcHRlIGFybV9scGFlX3Byb3RfdG9fcHRlKHN0
cnVjdCBhcm1fbHBhZV9pb19wZ3RhYmxlICpkYXRhLAogCWFybV9scGFlX2lvcHRlIHB0ZTsKIAog
CWlmIChkYXRhLT5pb3AuZm10ID09IEFSTV82NF9MUEFFX1MxIHx8Ci0JICAgIGRhdGEtPmlvcC5m
bXQgPT0gQVJNXzMyX0xQQUVfUzEpIHsKKwkgICAgZGF0YS0+aW9wLmZtdCA9PSBBUk1fMzJfTFBB
RV9TMSB8fAorCSAgICBkYXRhLT5pb3AuZm10ID09IEFSTV9BRFJFTk9fR1BVX0xQQUUpIHsKIAkJ
cHRlID0gQVJNX0xQQUVfUFRFX25HOwogCQlpZiAoIShwcm90ICYgSU9NTVVfV1JJVEUpICYmIChw
cm90ICYgSU9NTVVfUkVBRCkpCiAJCQlwdGUgfD0gQVJNX0xQQUVfUFRFX0FQX1JET05MWTsKQEAg
LTQ5Nyw2ICs1MTUsMjEgQEAgc3RhdGljIGludCBhcm1fbHBhZV9tYXAoc3RydWN0IGlvX3BndGFi
bGVfb3BzICpvcHMsIHVuc2lnbmVkIGxvbmcgaW92YSwKIAlyZXR1cm4gcmV0OwogfQogCitzdGF0
aWMgaW50IGFybV9hZHJlbm9fZ3B1X2xwYWVfbWFwKHN0cnVjdCBpb19wZ3RhYmxlX29wcyAqb3Bz
LAorCQl1bnNpZ25lZCBsb25nIGlvdmEsIHBoeXNfYWRkcl90IHBhZGRyLCBzaXplX3Qgc2l6ZSwK
KwkJaW50IGlvbW11X3Byb3QpCit7CisJc3RydWN0IGFybV9scGFlX2lvX3BndGFibGUgKmRhdGEg
PSBpb19wZ3RhYmxlX29wc190b19kYXRhKG9wcyk7CisJdW5zaWduZWQgbG9uZyBtYXNrID0gMVVM
IDw8IGRhdGEtPmlvcC5jZmcuaWFzOworCisJLyogVGhpcyBjb25maWd1cmF0aW9uIGV4cGVjdHMg
YWxsIGlvdmEgYWRkcmVzc2VzIHRvIGJlIGluIFRUQlIxICovCisJaWYgKFdBUk5fT04oaW92YSAm
IG1hc2spKQorCQlyZXR1cm4gLUVSQU5HRTsKKworCS8qIE1hc2sgb2ZmIHRoZSBzaWduIGV4dGVu
ZGVkIGJpdHMgYW5kIG1hcCBhcyB1c3VhbCAqLworCXJldHVybiBhcm1fbHBhZV9tYXAob3BzLCBp
b3ZhICYgKG1hc2sgLSAxKSwgcGFkZHIsIHNpemUsIGlvbW11X3Byb3QpOworfQorCiBzdGF0aWMg
dm9pZCBfX2FybV9scGFlX2ZyZWVfcGd0YWJsZShzdHJ1Y3QgYXJtX2xwYWVfaW9fcGd0YWJsZSAq
ZGF0YSwgaW50IGx2bCwKIAkJCQkgICAgYXJtX2xwYWVfaW9wdGUgKnB0ZXApCiB7CkBAIC02NDMs
NiArNjc2LDIyIEBAIHN0YXRpYyBzaXplX3QgX19hcm1fbHBhZV91bm1hcChzdHJ1Y3QgYXJtX2xw
YWVfaW9fcGd0YWJsZSAqZGF0YSwKIAlyZXR1cm4gX19hcm1fbHBhZV91bm1hcChkYXRhLCBpb3Zh
LCBzaXplLCBsdmwgKyAxLCBwdGVwKTsKIH0KIAorc3RhdGljIHNpemVfdCBhcm1fYWRyZW5vX2dw
dV9scGFlX3VubWFwKHN0cnVjdCBpb19wZ3RhYmxlX29wcyAqb3BzLAorCQkJCSAgIHVuc2lnbmVk
IGxvbmcgaW92YSwgc2l6ZV90IHNpemUpCit7CisJc3RydWN0IGFybV9scGFlX2lvX3BndGFibGUg
KmRhdGEgPSBpb19wZ3RhYmxlX29wc190b19kYXRhKG9wcyk7CisJYXJtX2xwYWVfaW9wdGUgKnB0
ZXAgPSBkYXRhLT5wZ2Q7CisJaW50IGx2bCA9IEFSTV9MUEFFX1NUQVJUX0xWTChkYXRhKTsKKwl1
bnNpZ25lZCBsb25nIG1hc2sgPSAxVUwgPDwgZGF0YS0+aW9wLmNmZy5pYXM7CisKKwkvKiBNYWtl
IHN1cmUgdGhlIHNpZ24gZXh0ZW5kIGJpdCBpcyBzZXQgaW4gdGhlIGlvdmEgKi8KKwlpZiAoV0FS
Tl9PTighKGlvdmEgJiBtYXNrKSkpCisJCXJldHVybiAwOworCisJLyogTWFzayBvZmYgdGhlIHNp
Z24gZXh0ZW5kZWQgYml0cyBiZWZvcmUgdW5tYXBwaW5nICovCisJcmV0dXJuIF9fYXJtX2xwYWVf
dW5tYXAoZGF0YSwgaW92YSAmIChtYXNrIC0gMSksIHNpemUsIGx2bCwgcHRlcCk7Cit9CisKIHN0
YXRpYyBzaXplX3QgYXJtX2xwYWVfdW5tYXAoc3RydWN0IGlvX3BndGFibGVfb3BzICpvcHMsIHVu
c2lnbmVkIGxvbmcgaW92YSwKIAkJCSAgICAgc2l6ZV90IHNpemUpCiB7CkBAIC02OTIsNiArNzQx
LDE3IEBAIHN0YXRpYyBwaHlzX2FkZHJfdCBhcm1fbHBhZV9pb3ZhX3RvX3BoeXMoc3RydWN0IGlv
X3BndGFibGVfb3BzICpvcHMsCiAJcmV0dXJuIGlvcHRlX3RvX3BhZGRyKHB0ZSwgZGF0YSkgfCBp
b3ZhOwogfQogCisKK3N0YXRpYyBwaHlzX2FkZHJfdCBhcm1fYWRyZW5vX2dwdV9scGFlX2lvdmFf
dG9fcGh5cyhzdHJ1Y3QgaW9fcGd0YWJsZV9vcHMgKm9wcywKKwkJCQkJICAgICAgIHVuc2lnbmVk
IGxvbmcgaW92YSkKK3sKKwlzdHJ1Y3QgYXJtX2xwYWVfaW9fcGd0YWJsZSAqZGF0YSA9IGlvX3Bn
dGFibGVfb3BzX3RvX2RhdGEob3BzKTsKKwl1bnNpZ25lZCBsb25nIG1hc2sgPSAxVUwgPDwgZGF0
YS0+aW9wLmNmZy5pYXM7CisKKwkvKiBNYXNrIG9mZiB0aGUgc2lnbiBleHRlbmRlZCBiaXRzIGJl
Zm9yZSB0cmFuc2xhdGluZyAqLworCXJldHVybiBhcm1fbHBhZV9pb3ZhX3RvX3BoeXMob3BzLCBp
b3ZhICYgKG1hc2sgLSAxKSk7Cit9CisKIHN0YXRpYyB2b2lkIGFybV9scGFlX3Jlc3RyaWN0X3Bn
c2l6ZXMoc3RydWN0IGlvX3BndGFibGVfY2ZnICpjZmcpCiB7CiAJdW5zaWduZWQgbG9uZyBncmFu
dWxlLCBwYWdlX3NpemVzOwpAQCAtNzcxLDE3ICs4MzEsMTYgQEAgYXJtX2xwYWVfYWxsb2NfcGd0
YWJsZShzdHJ1Y3QgaW9fcGd0YWJsZV9jZmcgKmNmZykKIAlwZ2RfYml0cyA9IHZhX2JpdHMgLSAo
ZGF0YS0+Yml0c19wZXJfbGV2ZWwgKiAoZGF0YS0+bGV2ZWxzIC0gMSkpOwogCWRhdGEtPnBnZF9z
aXplID0gMVVMIDw8IChwZ2RfYml0cyArIGlsb2cyKHNpemVvZihhcm1fbHBhZV9pb3B0ZSkpKTsK
IAotCWRhdGEtPmlvcC5vcHMgPSAoc3RydWN0IGlvX3BndGFibGVfb3BzKSB7Ci0JCS5tYXAJCT0g
YXJtX2xwYWVfbWFwLAotCQkudW5tYXAJCT0gYXJtX2xwYWVfdW5tYXAsCi0JCS5pb3ZhX3RvX3Bo
eXMJPSBhcm1fbHBhZV9pb3ZhX3RvX3BoeXMsCi0JfTsKIAogCXJldHVybiBkYXRhOwogfQogCi1z
dGF0aWMgc3RydWN0IGlvX3BndGFibGUgKgotYXJtXzY0X2xwYWVfYWxsb2NfcGd0YWJsZV9zMShz
dHJ1Y3QgaW9fcGd0YWJsZV9jZmcgKmNmZywgdm9pZCAqY29va2llKQorLyoKKyAqIENvbW1vbiBh
bGxvY2F0aW9uIGZ1bmN0aW9uIGZvciBTMSBwYWdldGFibGVzLiAgU2V0IHVwIHRoZSBUVEJSMCBy
ZWdpb24gYW5kCisgKiBhbGxvY2F0ZSBhIGRlZmF1bHQgcGFnZXRhYmxlCisgKi8KK3N0YXRpYyBz
dHJ1Y3QgYXJtX2xwYWVfaW9fcGd0YWJsZSAqCitfYXJtXzY0X2xwYWVfYWxsb2NfcGd0YWJsZV9z
MV9jb21tb24oc3RydWN0IGlvX3BndGFibGVfY2ZnICpjZmcpCiB7CiAJdTY0IHJlZzsKIAlzdHJ1
Y3QgYXJtX2xwYWVfaW9fcGd0YWJsZSAqZGF0YTsKQEAgLTg0NSw4ICs5MDQsNiBAQCBhcm1fNjRf
bHBhZV9hbGxvY19wZ3RhYmxlX3MxKHN0cnVjdCBpb19wZ3RhYmxlX2NmZyAqY2ZnLCB2b2lkICpj
b29raWUpCiAKIAlyZWcgfD0gKDY0VUxMIC0gY2ZnLT5pYXMpIDw8IEFSTV9MUEFFX1RDUl9UMFNa
X1NISUZUOwogCi0JLyogRGlzYWJsZSBzcGVjdWxhdGl2ZSB3YWxrcyB0aHJvdWdoIFRUQlIxICov
Ci0JcmVnIHw9IEFSTV9MUEFFX1RDUl9FUEQxOwogCWNmZy0+YXJtX2xwYWVfczFfY2ZnLnRjciA9
IHJlZzsKIAogCS8qIE1BSVJzICovCkBAIC04NzAsMTYgKzkyNywxMzEgQEAgYXJtXzY0X2xwYWVf
YWxsb2NfcGd0YWJsZV9zMShzdHJ1Y3QgaW9fcGd0YWJsZV9jZmcgKmNmZywgdm9pZCAqY29va2ll
KQogCS8qIEVuc3VyZSB0aGUgZW1wdHkgcGdkIGlzIHZpc2libGUgYmVmb3JlIGFueSBhY3R1YWwg
VFRCUiB3cml0ZSAqLwogCXdtYigpOwogCi0JLyogVFRCUnMgKi8KLQljZmctPmFybV9scGFlX3Mx
X2NmZy50dGJyWzBdID0gdmlydF90b19waHlzKGRhdGEtPnBnZCk7Ci0JY2ZnLT5hcm1fbHBhZV9z
MV9jZmcudHRiclsxXSA9IDA7Ci0JcmV0dXJuICZkYXRhLT5pb3A7Ci0KKwlyZXR1cm4gZGF0YTsK
IG91dF9mcmVlX2RhdGE6CiAJa2ZyZWUoZGF0YSk7CiAJcmV0dXJuIE5VTEw7CiB9CiAKKworc3Rh
dGljIHN0cnVjdCBpb19wZ3RhYmxlICoKK2FybV9hZHJlbm9fZ3B1X2xwYWVfYWxsb2NfcGd0YWJs
ZShzdHJ1Y3QgaW9fcGd0YWJsZV9jZmcgKmNmZywgdm9pZCAqY29va2llKQoreworCXN0cnVjdCBh
cm1fbHBhZV9pb19wZ3RhYmxlICpkYXRhOworCXU2NCByZWc7CisKKwkvKgorCSAqIE1ha2Ugc3Vy
ZSB0aGUgaWFzIGFsaWducyB3aXRoIHRoZSBhdmFpbGFibGUgb3B0aW9ucyBmb3IgdGhlIHNpZ24K
KwkgKiBleHRlbnNpb24gYml0CisJICovCisJc3dpdGNoIChjZmctPmlhcykgeworCWNhc2UgMzI6
CisJY2FzZSAzNjoKKwljYXNlIDQwOgorCWNhc2UgNDI6CisJY2FzZSA0NDoKKwkJLyoKKwkJICog
VGhlIFNFUCB3aWxsIGJlIHRoZSBoaWdoZXN0IGF2YWlsYWJsZSBiaXQgc28gYWRqdXN0IHRoZSBk
YXRhCisJCSAqIHNpemUgYnkgb25lIHRvIGFjY29tbW9kYXRlIGl0CisJCSAqLworCQljZmctPmlh
cy0tOworCQlicmVhazsKKwljYXNlIDQ4OgorCQkvKgorCQkgKiBJQVMgb2YgNDggaXMgYSBzcGVj
aWFsIGNhc2UsIGl0IGhhcyBhIGRlZGljYXRlZCBzaWduCisJCSAqIGV4dGVuc2lvbiBiaXQgc28g
d2UgY2FuIHVzZSB0aGUgZnVsbCBJQVMgc2l6ZQorCQkgKi8KKwkJYnJlYWs7CisJZGVmYXVsdDoK
KwkJLyogVGhlIGlhcyBkb2Vzbid0IHdvcmsgZm9yIHRoZSBhdmFpbGFibGUgU0VQIG9wdGlvbnMg
Ki8KKwkJcmV0dXJuIE5VTEw7CisJfQorCisJZGF0YSA9IF9hcm1fNjRfbHBhZV9hbGxvY19wZ3Rh
YmxlX3MxX2NvbW1vbihjZmcpOworCWlmICghZGF0YSkKKwkJcmV0dXJuIE5VTEw7CisKKwlyZWcg
PSAoQVJNX0xQQUVfVENSX1NIX0lTIDw8IEFSTV9MUEFFX1RDUl9TSDFfU0hJRlQpIHwKKwkgICAg
ICAoQVJNX0xQQUVfVENSX1JHTl9XQldBIDw8IEFSTV9MUEFFX1RDUl9JUkdOMV9TSElGVCkgfAor
CSAgICAgIChBUk1fTFBBRV9UQ1JfUkdOX1dCV0EgPDwgQVJNX0xQQUVfVENSX09SR04xX1NISUZU
KTsKKworCXN3aXRjaCAoQVJNX0xQQUVfR1JBTlVMRShkYXRhKSkgeworCWNhc2UgU1pfNEs6CisJ
CXJlZyB8PSBBUk1fTFBBRV9UQ1JfVEcxXzRLOworCQlicmVhazsKKwljYXNlIFNaXzE2SzoKKwkJ
cmVnIHw9IEFSTV9MUEFFX1RDUl9URzFfMTZLOworCQlicmVhazsKKwljYXNlIFNaXzY0SzoKKwkJ
cmVnIHw9IEFSTV9MUEFFX1RDUl9URzFfNjRLOworCQlicmVhazsKKwl9CisKKwlyZWcgfD0gKDY0
VUxMIC0gY2ZnLT5pYXMpIDw8IEFSTV9MUEFFX1RDUl9UMVNaX1NISUZUOworCisJLyogU2V0IHRo
ZSBzaWduIGV4dGVuc2lvbiBiaXQgKi8KKwlzd2l0Y2ggKGNmZy0+aWFzKSB7CisJY2FzZSAzMToK
KwkJcmVnIHw9IEFSTV9MUEFFX1RDUl9TRVBfMzE7CisJCWJyZWFrOworCWNhc2UgMzU6CisJCXJl
ZyB8PSBBUk1fTFBBRV9UQ1JfU0VQXzM1OworCQlicmVhazsKKwljYXNlIDM5OgorCQlyZWcgfD0g
QVJNX0xQQUVfVENSX1NFUF8zOTsKKwkJYnJlYWs7CisJY2FzZSA0MToKKwkJcmVnIHw9IEFSTV9M
UEFFX1RDUl9TRVBfNDE7CisJCWJyZWFrOworCWNhc2UgNDM6CisJCXJlZyB8PSBBUk1fTFBBRV9U
Q1JfU0VQXzQzOworCQlicmVhazsKKwljYXNlIDQ4OgorCQlyZWcgfD0gQVJNX0xQQUVfVENSX1NF
UF9VUFNUUkVBTTsKKwkJYnJlYWs7CisJfQorCisJY2ZnLT5hcm1fbHBhZV9zMV9jZmcudGNyIHw9
IHJlZzsKKworCS8qIFNldCB0aGUgYWxsb2NhdGVkIHBnZCB0byB0dGJyMSBhbmQgbGVhdmUgdHRi
cjAgZW1wdHkgKi8KKwljZmctPmFybV9scGFlX3MxX2NmZy50dGJyWzBdID0gMDsKKwljZmctPmFy
bV9scGFlX3MxX2NmZy50dGJyWzFdID0gdmlydF90b19waHlzKGRhdGEtPnBnZCk7CisKKwkvKiBT
ZXQgdXNlIGNhc2Ugc3BlY2lmaWMgcGd0YWJsZSBoZWxwZXJzICovCisJZGF0YS0+aW9wLm9wcyA9
IChzdHJ1Y3QgaW9fcGd0YWJsZV9vcHMpIHsKKwkJLm1hcAkJPSBhcm1fYWRyZW5vX2dwdV9scGFl
X21hcCwKKwkJLnVubWFwCQk9IGFybV9hZHJlbm9fZ3B1X2xwYWVfdW5tYXAsCisJCS5pb3ZhX3Rv
X3BoeXMJPSBhcm1fYWRyZW5vX2dwdV9scGFlX2lvdmFfdG9fcGh5cywKKwl9OworCisJcmV0dXJu
ICZkYXRhLT5pb3A7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgaW9fcGd0YWJsZSAqCithcm1fNjRfbHBh
ZV9hbGxvY19wZ3RhYmxlX3MxKHN0cnVjdCBpb19wZ3RhYmxlX2NmZyAqY2ZnLCB2b2lkICpjb29r
aWUpCit7CisJc3RydWN0IGFybV9scGFlX2lvX3BndGFibGUgKmRhdGE7CisKKwlkYXRhID0gX2Fy
bV82NF9scGFlX2FsbG9jX3BndGFibGVfczFfY29tbW9uKGNmZyk7CisJaWYgKCFkYXRhKQorCQly
ZXR1cm4gTlVMTDsKKworCS8qIERpc2FibGUgc3BlY3VsYXRpdmUgd2Fsa3MgdGhyb3VnaCBUVEJS
MSAqLworCWNmZy0+YXJtX2xwYWVfczFfY2ZnLnRjciB8PSBBUk1fTFBBRV9UQ1JfRVBEMTsKKwor
CS8qIFNldCB0aGUgcGdkIHRvIFRUQlIwICovCisJY2ZnLT5hcm1fbHBhZV9zMV9jZmcudHRiclsw
XSA9IHZpcnRfdG9fcGh5cyhkYXRhLT5wZ2QpOworCWNmZy0+YXJtX2xwYWVfczFfY2ZnLnR0YnJb
MV0gPSAwOworCisJZGF0YS0+aW9wLm9wcyA9IChzdHJ1Y3QgaW9fcGd0YWJsZV9vcHMpIHsKKwkJ
Lm1hcAkJPSBhcm1fbHBhZV9tYXAsCisJCS51bm1hcAkJPSBhcm1fbHBhZV91bm1hcCwKKwkJLmlv
dmFfdG9fcGh5cwk9IGFybV9scGFlX2lvdmFfdG9fcGh5cywKKwl9OworCisJcmV0dXJuICZkYXRh
LT5pb3A7Cit9CisKIHN0YXRpYyBzdHJ1Y3QgaW9fcGd0YWJsZSAqCiBhcm1fNjRfbHBhZV9hbGxv
Y19wZ3RhYmxlX3MyKHN0cnVjdCBpb19wZ3RhYmxlX2NmZyAqY2ZnLCB2b2lkICpjb29raWUpCiB7
CkBAIC04OTQsNiArMTA2NiwxMiBAQCBhcm1fNjRfbHBhZV9hbGxvY19wZ3RhYmxlX3MyKHN0cnVj
dCBpb19wZ3RhYmxlX2NmZyAqY2ZnLCB2b2lkICpjb29raWUpCiAJaWYgKCFkYXRhKQogCQlyZXR1
cm4gTlVMTDsKIAorCWRhdGEtPmlvcC5vcHMgPSAoc3RydWN0IGlvX3BndGFibGVfb3BzKSB7CisJ
CS5tYXAJCT0gYXJtX2xwYWVfbWFwLAorCQkudW5tYXAJCT0gYXJtX2xwYWVfdW5tYXAsCisJCS5p
b3ZhX3RvX3BoeXMJPSBhcm1fbHBhZV9pb3ZhX3RvX3BoeXMsCisJfTsKKwogCS8qCiAJICogQ29u
Y2F0ZW5hdGUgUEdEcyBhdCBsZXZlbCAxIGlmIHBvc3NpYmxlIGluIG9yZGVyIHRvIHJlZHVjZQog
CSAqIHRoZSBkZXB0aCBvZiB0aGUgc3RhZ2UtMiB3YWxrLgpAQCAtMTA0MSw2ICsxMjE5LDExIEBA
IHN0cnVjdCBpb19wZ3RhYmxlX2luaXRfZm5zIGlvX3BndGFibGVfYXJtXzY0X2xwYWVfczFfaW5p
dF9mbnMgPSB7CiAJLmZyZWUJPSBhcm1fbHBhZV9mcmVlX3BndGFibGUsCiB9OwogCitzdHJ1Y3Qg
aW9fcGd0YWJsZV9pbml0X2ZucyBpb19wZ3RhYmxlX2FybV9hZHJlbm9fZ3B1X2xwYWVfaW5pdF9m
bnMgPSB7CisJLmFsbG9jCT0gYXJtX2FkcmVub19ncHVfbHBhZV9hbGxvY19wZ3RhYmxlLAorCS5m
cmVlCT0gYXJtX2xwYWVfZnJlZV9wZ3RhYmxlLAorfTsKKwogc3RydWN0IGlvX3BndGFibGVfaW5p
dF9mbnMgaW9fcGd0YWJsZV9hcm1fNjRfbHBhZV9zMl9pbml0X2ZucyA9IHsKIAkuYWxsb2MJPSBh
cm1fNjRfbHBhZV9hbGxvY19wZ3RhYmxlX3MyLAogCS5mcmVlCT0gYXJtX2xwYWVfZnJlZV9wZ3Rh
YmxlLApAQCAtMTExMiw2ICsxMjk1LDcgQEAgc3RhdGljIGludCBfX2luaXQgYXJtX2xwYWVfcnVu
X3Rlc3RzKHN0cnVjdCBpb19wZ3RhYmxlX2NmZyAqY2ZnKQogCXN0YXRpYyBjb25zdCBlbnVtIGlv
X3BndGFibGVfZm10IGZtdHNbXSA9IHsKIAkJQVJNXzY0X0xQQUVfUzEsCiAJCUFSTV82NF9MUEFF
X1MyLAorCQlBUk1fNjRfTFBBRV9UVEJSMV9TMSwKIAl9OwogCiAJaW50IGksIGo7CmRpZmYgLS1n
aXQgYS9kcml2ZXJzL2lvbW11L2lvLXBndGFibGUuYyBiL2RyaXZlcnMvaW9tbXUvaW8tcGd0YWJs
ZS5jCmluZGV4IGNlZDUzZTUuLmU0N2VkMmQgMTAwNjQ0Ci0tLSBhL2RyaXZlcnMvaW9tbXUvaW8t
cGd0YWJsZS5jCisrKyBiL2RyaXZlcnMvaW9tbXUvaW8tcGd0YWJsZS5jCkBAIC0yMCw2ICsyMCw3
IEBAIGlvX3BndGFibGVfaW5pdF90YWJsZVtJT19QR1RBQkxFX05VTV9GTVRTXSA9IHsKIAlbQVJN
XzY0X0xQQUVfUzFdID0gJmlvX3BndGFibGVfYXJtXzY0X2xwYWVfczFfaW5pdF9mbnMsCiAJW0FS
TV82NF9MUEFFX1MyXSA9ICZpb19wZ3RhYmxlX2FybV82NF9scGFlX3MyX2luaXRfZm5zLAogCVtB
Uk1fTUFMSV9MUEFFXSA9ICZpb19wZ3RhYmxlX2FybV9tYWxpX2xwYWVfaW5pdF9mbnMsCisJW0FS
TV9BRFJFTk9fR1BVX0xQQUVdID0gJmlvX3BndGFibGVfYXJtX2FkcmVub19ncHVfbHBhZV9pbml0
X2ZucywKICNlbmRpZgogI2lmZGVmIENPTkZJR19JT01NVV9JT19QR1RBQkxFX0FSTVY3UwogCVtB
Uk1fVjdTXSA9ICZpb19wZ3RhYmxlX2FybV92N3NfaW5pdF9mbnMsCmRpZmYgLS1naXQgYS9pbmNs
dWRlL2xpbnV4L2lvLXBndGFibGUuaCBiL2luY2x1ZGUvbGludXgvaW8tcGd0YWJsZS5oCmluZGV4
IGI1YTQ1MGEuLjQ4NzFlODUgMTAwNjQ0Ci0tLSBhL2luY2x1ZGUvbGludXgvaW8tcGd0YWJsZS5o
CisrKyBiL2luY2x1ZGUvbGludXgvaW8tcGd0YWJsZS5oCkBAIC0xMyw2ICsxMyw3IEBAIGVudW0g
aW9fcGd0YWJsZV9mbXQgewogCUFSTV82NF9MUEFFX1MyLAogCUFSTV9WN1MsCiAJQVJNX01BTElf
TFBBRSwKKwlBUk1fQURSRU5PX0dQVV9MUEFFLAogCUlPX1BHVEFCTEVfTlVNX0ZNVFMsCiB9Owog
CkBAIC0yMTMsNSArMjE0LDYgQEAgZXh0ZXJuIHN0cnVjdCBpb19wZ3RhYmxlX2luaXRfZm5zIGlv
X3BndGFibGVfYXJtXzY0X2xwYWVfczFfaW5pdF9mbnM7CiBleHRlcm4gc3RydWN0IGlvX3BndGFi
bGVfaW5pdF9mbnMgaW9fcGd0YWJsZV9hcm1fNjRfbHBhZV9zMl9pbml0X2ZuczsKIGV4dGVybiBz
dHJ1Y3QgaW9fcGd0YWJsZV9pbml0X2ZucyBpb19wZ3RhYmxlX2FybV92N3NfaW5pdF9mbnM7CiBl
eHRlcm4gc3RydWN0IGlvX3BndGFibGVfaW5pdF9mbnMgaW9fcGd0YWJsZV9hcm1fbWFsaV9scGFl
X2luaXRfZm5zOworZXh0ZXJuIHN0cnVjdCBpb19wZ3RhYmxlX2luaXRfZm5zIGlvX3BndGFibGVf
YXJtX2FkcmVub19ncHVfbHBhZV9pbml0X2ZuczsKIAogI2VuZGlmIC8qIF9fSU9fUEdUQUJMRV9I
ICovCi0tIAoyLjcuNAoKX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX18KRnJlZWRyZW5vIG1haWxpbmcgbGlzdApGcmVlZHJlbm9AbGlzdHMuZnJlZWRlc2t0b3Au
b3JnCmh0dHBzOi8vbGlzdHMuZnJlZWRlc2t0b3Aub3JnL21haWxtYW4vbGlzdGluZm8vZnJlZWRy
ZW5v
