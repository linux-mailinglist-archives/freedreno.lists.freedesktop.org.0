Return-Path: <freedreno-bounces@lists.freedesktop.org>
X-Original-To: lists+freedreno@lfdr.de
Delivered-To: lists+freedreno@lfdr.de
Received: from gabe.freedesktop.org (gabe.freedesktop.org [IPv6:2610:10:20:722:a800:ff:fe36:1795])
	by mail.lfdr.de (Postfix) with ESMTPS id CC9CEAEE04
	for <lists+freedreno@lfdr.de>; Tue, 10 Sep 2019 17:01:43 +0200 (CEST)
Received: from gabe.freedesktop.org (localhost [127.0.0.1])
	by gabe.freedesktop.org (Postfix) with ESMTP id 7F6866E0F9;
	Tue, 10 Sep 2019 15:01:42 +0000 (UTC)
X-Original-To: freedreno@lists.freedesktop.org
Delivered-To: freedreno@lists.freedesktop.org
Received: from foss.arm.com (foss.arm.com [217.140.110.172])
 by gabe.freedesktop.org (Postfix) with ESMTP id C04316E0F9
 for <freedreno@lists.freedesktop.org>; Tue, 10 Sep 2019 15:01:40 +0000 (UTC)
Received: from usa-sjc-imap-foss1.foss.arm.com (unknown [10.121.207.14])
 by usa-sjc-mx-foss1.foss.arm.com (Postfix) with ESMTP id 65DD228;
 Tue, 10 Sep 2019 08:01:40 -0700 (PDT)
Received: from [10.1.197.57] (e110467-lin.cambridge.arm.com [10.1.197.57])
 by usa-sjc-imap-foss1.foss.arm.com (Postfix) with ESMTPSA id C724B3F71F;
 Tue, 10 Sep 2019 08:01:38 -0700 (PDT)
To: Rob Clark <robdclark@gmail.com>, iommu@lists.linux-foundation.org
References: <20190907175013.24246-1-robdclark@gmail.com>
From: Robin Murphy <robin.murphy@arm.com>
Message-ID: <418d8426-f299-1269-2b2e-f86677cf22c2@arm.com>
Date: Tue, 10 Sep 2019 16:01:37 +0100
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:60.0) Gecko/20100101
 Thunderbird/60.6.1
MIME-Version: 1.0
In-Reply-To: <20190907175013.24246-1-robdclark@gmail.com>
Content-Language: en-GB
Subject: Re: [Freedreno] [PATCH] iommu/arm-smmu: fix "hang" when games exit
X-BeenThere: freedreno@lists.freedesktop.org
X-Mailman-Version: 2.1.23
Precedence: list
List-Id: Freedreno graphics driver community testing & development
 <freedreno.lists.freedesktop.org>
List-Unsubscribe: <https://lists.freedesktop.org/mailman/options/freedreno>,
 <mailto:freedreno-request@lists.freedesktop.org?subject=unsubscribe>
List-Archive: <https://lists.freedesktop.org/archives/freedreno>
List-Post: <mailto:freedreno@lists.freedesktop.org>
List-Help: <mailto:freedreno-request@lists.freedesktop.org?subject=help>
List-Subscribe: <https://lists.freedesktop.org/mailman/listinfo/freedreno>,
 <mailto:freedreno-request@lists.freedesktop.org?subject=subscribe>
Cc: Rob Clark <robdclark@chromium.org>, Will Deacon <will@kernel.org>,
 linux-arm-msm@vger.kernel.org, Joerg Roedel <joro@8bytes.org>,
 open list <linux-kernel@vger.kernel.org>, freedreno@lists.freedesktop.org,
 "moderated list:ARM SMMU DRIVERS" <linux-arm-kernel@lists.infradead.org>
Content-Transfer-Encoding: base64
Content-Type: text/plain; charset="utf-8"; Format="flowed"
Errors-To: freedreno-bounces@lists.freedesktop.org
Sender: "Freedreno" <freedreno-bounces@lists.freedesktop.org>

T24gMDcvMDkvMjAxOSAxODo1MCwgUm9iIENsYXJrIHdyb3RlOgo+IEZyb206IFJvYiBDbGFyayA8
cm9iZGNsYXJrQGNocm9taXVtLm9yZz4KPiAKPiBXaGVuIGdhbWVzLCBicm93c2VyLCBvciBhbnl0
aGluZyB1c2luZyBhIGxvdCBvZiBHUFUgYnVmZmVycyBleGl0cywgdGhlcmUKPiBjYW4gYmUgbWFu
eSBodW5kcmVkcyBvciB0aG91c2FuZHMgb2YgYnVmZmVycyB0byB1bm1hcCBhbmQgZnJlZS4gIElm
IHRoZQo+IEdQVSBpcyBvdGhlcndpc2Ugc3VzcGVuZGVkLCB0aGlzIGNhbiBjYXVzZSBhcm0tc21t
dSB0byByZXN1bWUvc3VzcGVuZAo+IGZvciBlYWNoIGJ1ZmZlciwgcmVzdWx0aW5nIDUtMTAgc2Vj
b25kcyB3b3J0aCBvZiByZXByb2dyYW1taW5nIHRoZQo+IGNvbnRleHQgYmFuayAoYXJtX3NtbXVf
d3JpdGVfY29udGV4dF9iYW5rKCkvYXJtX3NtbXVfd3JpdGVfczJjcigpL2V0YykuCj4gVG8gdGhl
IHVzZXIgaXQgd291bGQgYXBwZWFyIHRoYXQgdGhlIHN5c3RlbSBpcyBsb2NrZWQgdXAuCj4gCj4g
QSBzaW1wbGUgc29sdXRpb24gaXMgdG8gdXNlIHBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKCkg
aW5zdGVhZCwgc28gd2UKPiBkb24ndCBpbW1lZGlhdGVseSBzdXNwZW5kIHRoZSBTTU1VIGRldmlj
ZS4KPiAKPiBTaWduZWQtb2ZmLWJ5OiBSb2IgQ2xhcmsgPHJvYmRjbGFya0BjaHJvbWl1bS5vcmc+
Cj4gLS0tCj4gTm90ZTogSSd2ZSB0aWVkIHRoZSBhdXRvc3VzcGVuZCBlbmFibGUvZGVsYXkgdG8g
dGhlIGNvbnN1bWVyIGRldmljZSwKPiBiYXNlZCBvbiB0aGUgcmVhc29uaW5nIHRoYXQgaWYgdGhl
IGNvbnN1bWVyIGRldmljZSBiZW5lZml0cyBmcm9tIHVzaW5nCj4gYW4gYXV0b3N1c3BlbmQgZGVs
YXksIHRoZW4gaXQncyBjb3JyZXNwb25kaW5nIFNNTVUgcHJvYmFibHkgZG9lcyB0b28uCj4gTWF5
YmUgdGhhdCBpcyBvdmVya2lsbCBhbmQgd2Ugc2hvdWxkIGp1c3QgdW5jb25kaXRpb25hbGx5IGVu
YWJsZQo+IGF1dG9zdXNwZW5kLgoKSSdtIG5vdCBzdXJlIHRoZXJlJ3MgcmVhbGx5IGFueSByZWFz
b24gdG8gZXhwZWN0IHRoYXQgYSBzdXBwbGllcidzIHVzYWdlIAptb2RlbCB3aGVuIGRvaW5nIHRo
aW5ncyBmb3IgaXRzZWxmIGJlYXJzIGFueSByZWxhdGlvbiB0byB0aGF0IG9mIGl0cyAKY29uc3Vt
ZXIocyksIHNvIEknZCBjZXJ0YWlubHkgbGVhbiB0b3dhcmRzIHRoZSAidW5jb25kaXRpb25hbCIg
YXJndW1lbnQgCm15c2VsZi4KCk9mIGNvdXJzZSBpZGVhbGx5IHdlJ2Qgc2tpcCByZXN1bWluZyBh
bHRvZ2V0aGVyIGluIHRoZSBtYXAvdW5tYXAgcGF0aHMgCihzaW5jZSByZXN1bWUgaW1wbGllcyBh
IGZ1bGwgVExCIHJlc2V0IGFueXdheSksIGJ1dCBJSVJDIHRoYXQgYXBwcm9hY2ggCnN0YXJ0ZWQg
dG8gZ2V0IG1lc3N5IGluIHRoZSBjb250ZXh0IG9mIHRoZSBpbml0aWFsIFJQTSBwYXRjaHNldC4g
SSdtIApwbGFubmluZyB0byBmaWRkbGUgYXJvdW5kIGEgYml0IG1vcmUgdG8gY2xlYW4gdXAgdGhl
IGltcGxlbWVudGF0aW9uIG9mIAp0aGUgbmV3IGlvbW11X2ZsdXNoX29wcyBzdHVmZiwgc28gSSd2
ZSBtYWRlIGEgbm90ZSB0byBteXNlbGYgdG8gcmV2aXNpdCAKUlBNIHRvIHNlZSBpZiB0aGVyZSdz
IGEgc3VmZmljaWVudGx5IGNsZWFuIHdheSB0byBkbyBiZXR0ZXIuIEluIHRoZSAKbWVhbnRpbWUs
IHRob3VnaCwgSSBkb24ndCBoYXZlIGFueSByZWFsIG9iamVjdGlvbiB0byB1c2luZyBzb21lIApy
ZWFzb25hYmxlIGF1dG9zdXNwZW5kIGRlbGF5IG9uIHRoZSBwcmluY2lwbGUgdGhhdCBpZiB3ZSd2
ZSBiZWVuIHdva2VuIAp1cCB0byBtYXAvdW5tYXAgb25lIHBhZ2UsIHRoZXJlJ3MgYSBoaWdoIGxp
a2VsaWhvb2QgdGhhdCBtb3JlIHdpbGwgCmZvbGxvdyBpbiBzaG9ydCBvcmRlciAoYW5kIGluIHRo
ZSBjb25maWd1cmF0aW9uIHNsb3ctcGF0aHMgaXQgd29uJ3QgaGF2ZSAKbXVjaCBpbXBhY3QgZWl0
aGVyIHdheSkuCgpSb2Jpbi4KCj4gICBkcml2ZXJzL2lvbW11L2FybS1zbW11LmMgfCAxMSArKysr
KysrKysrLQo+ICAgMSBmaWxlIGNoYW5nZWQsIDEwIGluc2VydGlvbnMoKyksIDEgZGVsZXRpb24o
LSkKPiAKPiBkaWZmIC0tZ2l0IGEvZHJpdmVycy9pb21tdS9hcm0tc21tdS5jIGIvZHJpdmVycy9p
b21tdS9hcm0tc21tdS5jCj4gaW5kZXggYzI3MzNiNDQ3ZDljLi43M2EwZGQ1M2M4YTMgMTAwNjQ0
Cj4gLS0tIGEvZHJpdmVycy9pb21tdS9hcm0tc21tdS5jCj4gKysrIGIvZHJpdmVycy9pb21tdS9h
cm0tc21tdS5jCj4gQEAgLTI4OSw3ICsyODksNyBAQCBzdGF0aWMgaW5saW5lIGludCBhcm1fc21t
dV9ycG1fZ2V0KHN0cnVjdCBhcm1fc21tdV9kZXZpY2UgKnNtbXUpCj4gICBzdGF0aWMgaW5saW5l
IHZvaWQgYXJtX3NtbXVfcnBtX3B1dChzdHJ1Y3QgYXJtX3NtbXVfZGV2aWNlICpzbW11KQo+ICAg
ewo+ICAgCWlmIChwbV9ydW50aW1lX2VuYWJsZWQoc21tdS0+ZGV2KSkKPiAtCQlwbV9ydW50aW1l
X3B1dChzbW11LT5kZXYpOwo+ICsJCXBtX3J1bnRpbWVfcHV0X2F1dG9zdXNwZW5kKHNtbXUtPmRl
dik7Cj4gICB9Cj4gICAKPiAgIHN0YXRpYyBzdHJ1Y3QgYXJtX3NtbXVfZG9tYWluICp0b19zbW11
X2RvbWFpbihzdHJ1Y3QgaW9tbXVfZG9tYWluICpkb20pCj4gQEAgLTE0NDUsNiArMTQ0NSwxNSBA
QCBzdGF0aWMgaW50IGFybV9zbW11X2F0dGFjaF9kZXYoc3RydWN0IGlvbW11X2RvbWFpbiAqZG9t
YWluLCBzdHJ1Y3QgZGV2aWNlICpkZXYpCj4gICAJLyogTG9va3Mgb2ssIHNvIGFkZCB0aGUgZGV2
aWNlIHRvIHRoZSBkb21haW4gKi8KPiAgIAlyZXQgPSBhcm1fc21tdV9kb21haW5fYWRkX21hc3Rl
cihzbW11X2RvbWFpbiwgZndzcGVjKTsKPiAgIAo+ICsjaWZkZWYgQ09ORklHX1BNCj4gKwkvKiBU
T0RPIG1heWJlIGRldmljZV9saW5rX2FkZCgpIHNob3VsZCBkbyB0aGlzIGZvciB1cz8gKi8KPiAr
CWlmIChkZXYtPnBvd2VyLnVzZV9hdXRvc3VzcGVuZCkgewo+ICsJCXBtX3J1bnRpbWVfc2V0X2F1
dG9zdXNwZW5kX2RlbGF5KHNtbXUtPmRldiwKPiArCQkJZGV2LT5wb3dlci5hdXRvc3VzcGVuZF9k
ZWxheSk7Cj4gKwkJcG1fcnVudGltZV91c2VfYXV0b3N1c3BlbmQoc21tdS0+ZGV2KTsKPiArCX0K
PiArI2VuZGlmCj4gKwo+ICAgcnBtX3B1dDoKPiAgIAlhcm1fc21tdV9ycG1fcHV0KHNtbXUpOwo+
ICAgCXJldHVybiByZXQ7Cj4gCl9fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19fX19f
X19fX19fX19fCkZyZWVkcmVubyBtYWlsaW5nIGxpc3QKRnJlZWRyZW5vQGxpc3RzLmZyZWVkZXNr
dG9wLm9yZwpodHRwczovL2xpc3RzLmZyZWVkZXNrdG9wLm9yZy9tYWlsbWFuL2xpc3RpbmZvL2Zy
ZWVkcmVubw==
